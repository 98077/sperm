<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head><!-- <meta name="baidu-site-verification" content="707024a76f8f40b549f07f478abab237"/> -->
<title>computational-advertising</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="computational-advertising"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2013-08-05 14:13:24 CST"/>
<meta name="author" content="dirtysalt"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style><link rel="stylesheet" type="text/css" href="./css/site-plain.css" />
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body><!-- <div id="bdshare" class="bdshare_t bds_tools_32 get-codes-bdshare"><a class="bds_tsina"></a><span class="bds_more"></span><a class="shareCount"></a></div> --><!-- Place this tag where you want the +1 button to render --><g:plusone annotation="inline"></g:plusone>


<div id="content">
<h1 class="title">computational-advertising</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 computational-advertising</a>
<ul>
<li><a href="#sec-1-1">1.1 在线广告综述</a>
<ul>
<li><a href="#sec-1-1-1">1.1.1 广告的定义与目的</a></li>
<li><a href="#sec-1-1-2">1.1.2 在线广告类型</a></li>
<li><a href="#sec-1-1-3">1.1.3 在线广告简史</a></li>
<li><a href="#sec-1-1-4">1.1.4 广告有效性原理</a></li>
<li><a href="#sec-1-1-5">1.1.5 在线广告相关行业协会</a></li>
</ul>
</li>
<li><a href="#sec-1-2">1.2 计算广告基础</a>
<ul>
<li><a href="#sec-1-2-1">1.2.1 在线广告的技术特点</a></li>
<li><a href="#sec-1-2-2">1.2.2 计算广告核心问题</a>
<ul>
<li><a href="#sec-1-2-2-1">1.2.2.1 在线广告技术课题</a></li>
<li><a href="#sec-1-2-2-2">1.2.2.2 在线广告计费模式</a></li>
</ul>
</li>
<li><a href="#sec-1-2-3">1.2.3 计算广告系统架构</a></li>
<li><a href="#sec-1-2-4">1.2.4 基础知识准备</a>
<ul>
<li><a href="#sec-1-2-4-1">1.2.4.1 信息检索</a></li>
<li><a href="#sec-1-2-4-2">1.2.4.2 向量空间模型</a></li>
<li><a href="#sec-1-2-4-3">1.2.4.3 最优化方法</a></li>
<li><a href="#sec-1-2-4-4">1.2.4.4 统计机器学习</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-1-3">1.3 合约广告</a>
<ul>
<li><a href="#sec-1-3-1">1.3.1 广告位售卖和排期系统</a></li>
<li><a href="#sec-1-3-2">1.3.2 担保式投送</a></li>
<li><a href="#sec-1-3-3">1.3.3 在线分配问题</a></li>
<li><a href="#sec-1-3-4">1.3.4 流量预测</a></li>
<li><a href="#sec-1-3-5">1.3.5 频次控制</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> computational-advertising</h2>
<div class="outline-text-2" id="text-1">



</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> 在线广告综述</h3>
<div class="outline-text-3" id="text-1-1">


</div>

<div id="outline-container-1-1-1" class="outline-4">
<h4 id="sec-1-1-1"><span class="section-number-4">1.1.1</span> 广告的定义与目的</h4>
<div class="outline-text-4" id="text-1-1-1">

<ul>
<li>参与方 
<ul>
<li>需求方(Demand): 可以是广告主(advertiser),代表广告主利益的代理商(agency)或者其它技术形态的采买方
</li>
<li>供给方(Supply): 可以是媒体,也可以是其他技术形态的变现平台。
</li>
<li>受众(Audience)
</li>
</ul>

</li>
<li>广告目的：广告主通过媒体达到低成本的用户接触。
</li>
<li>品牌广告(Brand Awareness): 希望借助媒体的力量来快速接触大量用户,以达到宣传品牌形象,提升中长期购买率与利润空间的目的。
</li>
<li>效果广告(Direct Response): 希望能利用广告手段马上带来大量的购买行为。
</li>
</ul>


</div>

</div>

<div id="outline-container-1-1-2" class="outline-4">
<h4 id="sec-1-1-2"><span class="section-number-4">1.1.2</span> 在线广告类型</h4>
<div class="outline-text-4" id="text-1-1-2">

<ul>
<li>条幅广告(Banner Ad): 这是显示广告中中最传统,也是最典型的形式。这种广告一般是嵌入在页面中相对固定位置的图片,与内容一样需要占据固定的版面。
</li>
<li>文字链广告(Textual Ad): 这种广告的素材形式是一段链接到广告主落地页的文字,在搜索广告中为主流形式,同时在媒体广告中也被广泛采用。
</li>
<li>富媒体广告(Rich Media Ad): 这类广告往往是利用视觉冲击力较强的表现形式,在不占用固定版面位置的情况下,向用户侵入式地投送广告素材。
<ul>
<li>富媒体广告常见的形式有弹窗、对 联、全屏等。它比较适合在高质量的媒体做一些品牌性质比较强的广告投放,但是对用户的使用体验往往影响也较大。
</li>
<li>一些门户网站的首页有时会为某个品牌广告主提供专门定制的、交互形式很复杂的富媒体广告, <b>这样的广告一般不采用受众定向的投送方式,也主要强调创意的冲击力和交互形式的特色。</b>
</li>
</ul>

</li>
<li>视频广告(Video Ad): 视频广告有两种最主要的形式:在视频内容播放之前的前插片广告,以及视频播放暂停时的广告。前插片广告一般采用短视频的形式,创意的冲击力和表现力要远远强于普通的显示广告,因此CPM价格往往也比较高;暂停广告则与普通的条幅广告区别不大。
</li>
<li>社交广告(Social Ad): 社交广告中最典型的形式,是插入在社交网络信息流中的广告,这种方式最早见于Twitter,产品称为“Promoted Tweets”。社交广告希望达到的效果,是通过用户的扩散式传播获 得更大的影响力,以及更可信的口碑.
</li>
<li>移动设备广告(Mobile Ad): 
</li>
<li>邮件营销广告(Email Direct Marketing, EDM):
</li>
</ul>


</div>

</div>

<div id="outline-container-1-1-3" class="outline-4">
<h4 id="sec-1-1-3"><span class="section-number-4">1.1.3</span> 在线广告简史</h4>
<div class="outline-text-4" id="text-1-1-3">

<ol>
<li>把网站的HTML页面当成是杂志的版面,在里面插入广告位,按照杂志的广告那样去售卖。
<ul>
<li>这种在互联网上展示条幅(banner)广告创意的产品形式,我们称为显示广告(Display Advertising)。
</li>
<li>合约式广告(Agreement-based Advertising): 即采用合同约定的方式确定某一广告位在某一时间段为某特定广告主所独占,并且根据双方的要求,确定广告创意的允许范围以及同一页面上的某种广告主排他策略。
</li>
</ul>

</li>
<li>我们是可以对不同的受众呈现不同的广告创意的! 定向广告(Targeted Advertising) <b>NOTE(dirlt):依然是合约式广告和显示广告</b>
<ul>
<li>受众定向(Audience Targeting),即通过技术手段标定某个用户的性别、年龄或其他标签。
</li>
<li>广告投放机(Ad Server),它将广告投送由直接嵌入页面变为实时响应前端请求,并根据用户标签自动决策和返回合适的广告创意。
</li>
<li>由于从传统的品牌广告市场直接延伸而来,此时的定向广告仍然以合约的方式进行:  <b>媒体向广告主保证某个投放量,并在此基础上确定合同的总金额以及量未完成情况下的赔偿方案。这种“担保式投送(Guaranteed Delivery)”</b> 的交易方式,逐渐成为互联网合约式广告的主要商业模式。
</li>
<li>一般来说,这样的广告合约仍然主要面向品牌广告主,并且按照按千次展示付费(Cost Per Mille, CPM)的计费方式。
</li>
<li>定向投放的最初动机,是供给方为了拆分流量以获得更高的营收。如果一开始就提供非常精细的定向,反而会造成售卖率的下降,因此,最初的定向标签往往都设置在在较粗的粒度上,最典型的是一些人口属性标签。 <b>NOTE（dirlt）：我的理解是，初期广告主也没有办法了解细分的定向</b> 
</li>
</ul>

</li>
<li>在受众定向的环境下合约广告系统问题和瓶颈
<ul>
<li>在满足各合约目标受众量要求的同时,尽可能为所有广告商分配到质更好的流量。
<ul>
<li>如何有效地将流量分配到各个合约互相交叉的人群覆盖上;
</li>
<li>在线的环境下实时且经济地完成每一次展示决策。
</li>
<li>在线分配问题（Online Allocation）
</li>
</ul>

</li>
<li>受众定向产生以后,市场向着精细化运作的方向快速发展,主要有两方面的发展趋势:
<ul>
<li>一是定向标签变得越来越精准;
</li>
<li>二是广告主的数量不断膨胀。
</li>
</ul>

</li>
<li>在这些趋势下,仍然按照合约的方式售卖广告会碰到越来越多的麻烦:
<ul>
<li>首先,很难对这些细粒度标签组合的流量做准确预估;
</li>
<li>其次,当一次展示同时满足多个合约的时候,仅仅按照量约束下的在线分配策略进行决策,有可能浪费掉了很多本来可以卖得更贵的流量
</li>
</ul>

</li>
</ul>

</li>
<li>大胆一点,抛弃量的保证,而采用最唯利是图的策略来进行广告决策? 竞价广告(Auction-based Advertising)。
<ul>
<li>在这种模式下,供给方只向广告主保证质即单位流量的成本,但不再以合约的方式给出量的保证, 换言之,对每一次展示,都基本按照收益最高的原则来决策。
</li>
<li>竞价广告产生的最初场景,是在互联网广告最主要的金矿搜索广告(Search Ad)中。从广告的视角来看,我们也可以把付费搜索看做一种定向广告,即根据用户的即时兴趣定向投送的广告,而即时兴趣的标签就是关键词。很显然,这 种定向广告从一开始就直接达到了非常精准的程度,也就很自然地采用了竞价的方式售卖。
</li>
<li>当搜索广告产生了巨大的收益以后,搜索引擎开始考虑将这样的变现方式推广到其他互联网媒体上:将用户的即时兴趣标签有搜索词换成正在浏览页面中提取的关键词,可以将这套竞价广告系统从搜索结果页照搬到媒体页面上,这就产生了上下文广告(Contextual Advertising)。
</li>
<li>从宏观市场上看,竞价广告与合约广告有很大的不同。没有了合约的保证,大量的广告主处在一个多方博弈的环境中。与直觉不同的是,在如何收取广告主费用这一点上,我们并非按照微观上最优的方案实施,就可以达到整个市场最大的收益。关于定价机制的深入研究,产生了广义第二高价(Generalized Second Pricing)这一竞价重要的理论。 <b>NOTE（dirlt）：竞价广告出现定价机制</b>
</li>
</ul>

</li>
<li>基于竞价机制和精准人群定向这两个核心功能,在线广告分化出了广告网络(Ad Network)这种新的市场形态。
<ul>
<li>它批量地运营媒体的广告位资源,按照人群或上下文标签售卖给需求方,在需求发生冲突时用竞价的方式决定流量分配。
</li>
<li>广告网络的结算,以按点击付费(Cost per Click, CPC)的方式为主。虽然我们不太能指 这种方式的千次展示收益(Revenue per Mille, RPM)可以达到合约式品牌广告的水平,但它使得大量中小互联网媒体有了切实可行的变现手段:这些媒体有一定的流量,但还不值得建立自己的销售团队面向品牌广告商售卖,直接把自己的广告库存(Inventory)托管给广告网络,借助广告网络的销售和代理团队为自己的流量变现。
</li>
</ul>

</li>
<li>这种面向多个广告网络或媒体按人群一站式采买广告，并优化投入产出比的需求方产品，我们称为自动交易终端(Automatic Trading Desk, ATD)。只能在广告网络定义好的定向标签组合上预先指定出价，而不能控制每一次展示的出价，因此，市场看起来象一个黑盒子，需求方只能靠选择合适的标签组合，以及阶段性调整出价来间接控制效果。
</li>
<li>在广告网络中,核心的竞价逻辑是封闭的。这种封闭的竞价机制,仍然不能完全满足需求方越来越明确的利益要求。这样的目标催生了实时竞价(Real Time Bidding)技术。
<ul>
<li>试想下面的两个例子:一、某电子商务网站需要通过一次广告投放来向它的忠实用户推广某产品;二、某银行希望通过自己的信用卡用户在网络上找到类似 的潜在用户群,并通过广告争取这批潜在用户。 <b>NOTE（dirlt）：主要是这个受众定向太具体了，广告网络不可能计算出来什么是所谓的忠实用户因为和电商网站的访问数据过于相关</b>
</li>
<li>很显然,任何广告网络都不可能直接为这两个需 求提供人群标签。与其想办法满足这些不断产生的定制化需求,不如干脆设计一种开放的竞价逻 辑,让需求方按自己的人群定义来挑选流量!
</li>
<li>所谓实时竞价,就是把拍卖的过程由广告主预先出价,变成每次展示时实时出价。只要把广告展示的上下文页面url,以及访客的cookie等信息传给需求方,它就有充分的信息来完成定制化的人群选择和出价。
</li>
</ul>

</li>
<li>需要注意的是,越是定制化的人群选择,往往就越精细,也就意味着单一媒体能达到的reach会相当有限。于是,市场上产生了大量聚合各媒体的剩余流量,采用实时竞价方式为他们变现的产品形态：广告交易平台(Ad Exchange)。 <b>NOTE（dirlt）：将各式各样的媒体信息聚合起来使用</b>
</li>
<li>通过实时竞价的方式，按照定制化的人群标签购买广告，这样与广告交易平台接口的产品，我们称为需求方平台(Demand Side Platform, DSP)。因为充分的环境信息使得深入的计算和估计成为可能。基于DSP的广告采买，非常类似于股票市场上的程序交易，我们把这样的广告采买方式也叫做程序购买(Programmatic Buy)。
</li>
</ol>


</div>

</div>

<div id="outline-container-1-1-4" class="outline-4">
<h4 id="sec-1-1-4"><span class="section-number-4">1.1.4</span> 广告有效性原理</h4>
<div class="outline-text-4" id="text-1-1-4">

<p>广告效果生成过程
</p>
<p>
<img src="./images/ad-effect-procedure.png"  alt="./images/ad-effect-procedure.png" />
</p>
<p>
根据上图,这以有效性模型把广告活动的整个信息接收过程分为三个大阶段:选择(Selection)、解释(Interpretation)与态度(Attitude);或者进一步分解为六个小阶段:曝光、关注、理解、接受、保持与决策,其中每两个小阶段对应一个大阶段。
</p>
<p>
定性地说,越靠前的阶段,其效果的改善对点击率的贡献越大;而越靠后的阶段,其效果的改善对转化率的贡献越大。
</p>
<ul>
<li>曝光(Exposure)阶段: 这一阶段指的是广告物理上展现出来的过程。此阶段的有效性往往与广告位的物理属性有关,并没有太多可以通过技术优化的空间。实际的广告实践中,曝光的有效性对最终结果的影响往往远远高于其他技术性因素。
</li>
<li>关注(Attention)阶段:这一阶段指的是受众从物理上接触到广告到意识上注意到它的过程。那么如何使得关注阶段的效率提高呢?我们介绍几个重要的原则:
<ol>
<li>尽量不要打断用户的任务。
</li>
<li>明确传达向用户推送此广告的原因,这一点是受众定向广告创意优化的重要方向。
</li>
<li>内容符合用户的兴趣或需求,这是受众定向的原理基础。
</li>
</ol>

</li>
<li>理解(Comprehension)阶段:受众意识到了广告的存在,并不意味着他一定能够理解广告传达的信息。理解阶段有哪些原则呢?
<ol>
<li>广告内容要在用户能理解的具体兴趣范围内,这就说明了真正精准的受众定向有多么必要。
</li>
<li>要注意设定与关注程度相匹配的理解门槛。
<ul>
<li>电视广告中,可以用有一定情节的短故事来宣传品牌;
</li>
<li>在路牌广告中,创意制作原则是将若干主要市场诉求都表达出来;
</li>
<li>而对于互联网广告,由于用户的关注程度非常低,我们应该集中强调一个主要诉求以吸引用户的注意力。
</li>
</ul>

</li>
</ol>

</li>
<li>接受(Acceptance)阶段:受众理解了广告传达的信息,并不一定表示他认可这些信息。
<ul>
<li>广告的上下文环境对于广告的接受程度也有着很大的影响, 同一个品牌广告出现在某游戏社区上和门户网站首页上,用户会倾向于认为后者更具说服力,这也就是优质媒体的品牌价值。
</li>
<li>在定向广告越来越普遍的今天,如何让合适的广告出现在合适的媒体上,即广告安全(Ad Safety)的问题,正在引起大家越来越多的关注。
</li>
</ul>

</li>
<li>保持(Retention)阶段:对于不仅仅追求短期转化的广告商,当然希望广告传达的信息给用户留下长久的记忆,以影响他长时间的选择。
</li>
<li>决策(Decision)阶段:成功广告的最终作用是带来用户的转化行为,虽然这一阶段已经离开了广告的业务范围,但好的广告还是能够为转化率的提高做好铺垫。
</li>
</ul>


</div>

</div>

<div id="outline-container-1-1-5" class="outline-4">
<h4 id="sec-1-1-5"><span class="section-number-4">1.1.5</span> 在线广告相关行业协会</h4>
<div class="outline-text-4" id="text-1-1-5">

<ul>
<li>交互广告局(Interactive Advertising Bureau, IAB)。
<ul>
<li>IAB主要是站在供给方的长远利益上来研究和影响市场。换句话说,IAB主要关注的是在线广告供给方的利益。
</li>
<li>因此,IAB的典型会员是Google, Facebook, Yahoo!, Microsoft这样的广告供给方,以及和AudienceScience, MediaMath这样的广告技术公司。
</li>
<li>从具体工作上看,IAB与互联网大量媒体和广告平台合作,制定了一系列意义重大的标准和规范,这些都极大地促进了在线广告行业的健康发展。其中几个重要的规范有:
<ol>
<li>条幅广告创意尺寸标准。
</li>
<li>视频广告标准VAST(Digital Video Ad Serving Template)。
</li>
<li>通用实时竞价接口标准OpenRTB。
</li>
</ol>

</li>
</ul>

</li>
<li>美国广告代理协会(American Association of Advertising Agencies, 4A)。
<ul>
<li>4A并不是一个专门从事互联网广告的组织,而是线上线下各种广告,特别是品牌广告的代理商在美国的行业协会。
</li>
<li>4A公司向其会员代理公司约定,至少要向广告主收取17.65%的服务费用,这一方面是为了避免行业内的恶性竞争,另一方面也是确保广告代理公司能够站在广告主的利益角度考虑问题,而后一点对于市场的长期健康发展是有很大帮助的。
</li>
<li>4A公司的典型代表有奥美(Ogilvy &amp; Mather)、智威汤逊(JWT)、麦肯(McCann) 等。
</li>
</ul>

</li>
<li>美国国家广告商协会(Association of National Advertisers, ANA)。
<ul>
<li>ANA是一个广告主的协会,也是最彻底地代表需求方利益的组织。其会员多是AT&amp;T, 宝洁(P&amp;G), NBA这些拥有大量广告预算的广告主。
</li>
</ul>

</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> 计算广告基础</h3>
<div class="outline-text-3" id="text-1-2">


</div>

<div id="outline-container-1-2-1" class="outline-4">
<h4 id="sec-1-2-1"><span class="section-number-4">1.2.1</span> 在线广告的技术特点</h4>
<div class="outline-text-4" id="text-1-2-1">

<ul>
<li>技术和计算导向。数字媒体的特点使在线广告可以进行精细的受众定向,技术又使得广告决策和交易朝着计算驱动的方向发展。除了受众定向,由于在线广告中独特拍卖性质的市场的存在,对于广告效果精确的预估和优化能力也是非常重要的。可以说,从来没有任何传统广告形式象在线广告那样,需要大规模地收集并利用数据,而这正是在线广告最吸引人之处。
</li>
<li>效果的可衡量性。在线广告刚刚产生的时候,大家对这种广告最多的称道之处,是它可以以展示和点击日志的形式直接记录广告效果。当然,我们也可以利用这些日志优化广告效果, 这同样是计算广告非常重要的方法论。
</li>
<li>创意和投放方式的标准化。标准化的驱动力来自于受众定向与程序购买。既然需求方关心的是人群而非广告位,创意尺寸的统一化与一些关键接口的标准化非常关键。
</li>
<li>媒体概念的多样化。随着Web 2.0的普及,赋予了更多交互功能的互联网媒体与线下媒体 有大有不同。随着交互功能的不同,这些媒体与转化行为的距离也就不同。
<ul>
<li>举个例子,对在线购 物行业而言,门户网站、垂直网站、搜索引擎、电商网站、返利网,在转化链条上一个比一个更靠近购买行为。
</li>
<li>我们从直观就可以知道,越接近需求方的媒体上的广告,其带来的流量一定可以达到越高的ROI,不过离“引导潜在用户”这样的广告目的也就越远。
</li>
<li>因此我们在从需求方看在线广告时,应该注重各种性质媒体的配合关系,并从整合营销的角度去审视和优化整体的效果。
</li>
</ul>

</li>
<li>数据驱动的投放决策。与工业革命时期机器化的根本驱动力电力相类比,互联网化的根本驱动力可以认为是数据的深入加工和利用。
</li>
</ul>


</div>

</div>

<div id="outline-container-1-2-2" class="outline-4">
<h4 id="sec-1-2-2"><span class="section-number-4">1.2.2</span> 计算广告核心问题</h4>
<div class="outline-text-4" id="text-1-2-2">

<ul>
<li>计算广告的核心问题,是为一系列用户与环境的组合,找到最合适的广告投放策略以优化整体的投入产出比(ROI)。
</li>
<li>对一个广告市场中具体的产品形态而言,我们往往能够主动优化的是产出(return)而非投入(investment)的部分,因此,我们主要关注回报的部分。定量地表示了某次或若干次展示的期望CPM值,我们称之为expected CPM(eCPM)。
</li>
<li>eCPM 它是计算广告中最常被提及,也最有代表性的定量评估收益的指标,本书中有大量的计算问题都是围绕它展开的。
</li>
</ul>



</div>

<div id="outline-container-1-2-2-1" class="outline-5">
<h5 id="sec-1-2-2-1"><span class="section-number-5">1.2.2.1</span> 在线广告技术课题</h5>
<div class="outline-text-5" id="text-1-2-2-1">

<p>算法优化：
</p><ul>
<li>即对a(ad), u(user), c(context) 打标签以方便挖掘的技术,对应产生了受众定向问题
</li>
<li>如果不考虑全局最优,则主要依靠eCPM估计,特别是CTR预测来完成每一次展示时的局部优化
</li>
<li>如果考虑到量的限制和投放时即时决策的要求,就产生了在线分配的问题
</li>
<li>为了在多方博弈的市场中达到动态平衡时的收益最大化,则需要对定价策略做深入研究
</li>
<li>为了更全面地采样整个(a, u, c) 的空间以便更准确地估计点击率,需要用到强化学习(Reinforcement Learning)中的探索与利用(Explore and Exploit, E&amp;E)算法
</li>
<li>而在DSP快速发展的今天,推荐算法也被广泛使用在个性化重定向当中。
</li>
</ul>


<p>
系统架构：
</p><ul>
<li>我们需要用到实时索引技术服务于广告候选的检索
</li>
<li>用到No-SQL的在线存储技术为投放时提供用户、上下文标签和其他特征
</li>
<li>大量使用Hadoop这样的分布式计算平台进行大规模数据挖掘
</li>
<li>用到最新的流计算平台实现短时用户行为反馈
</li>
<li>以及在广告交易环境下实现高并发、快速响应的的实时竞价接口
</li>
<li>还需要许多有关HTML协议和前端展示的技术来完成广告的具体投放
</li>
</ul>


</div>

</div>

<div id="outline-container-1-2-2-2" class="outline-5">
<h5 id="sec-1-2-2-2"><span class="section-number-5">1.2.2.2</span> 在线广告计费模式</h5>
<div class="outline-text-5" id="text-1-2-2-2">

<ul>
<li>CPM(Cost per Mille)计费,即按照千次展示计费,这里的“mille”是拉丁文“千次”的意思。
<ul>
<li><b>而对于品牌广告,由于效果和目的有时不便于直接衡量,可以考虑按照CPM的方式计费。</b>
</li>
<li>这种方式,是供给方与需求方约定好千次展示的计费标准,至于这些展示是否能够带来相应的收益,由需求方来估计和控制其中的风险。
</li>
<li>对于品牌广告,由于目标是较长时期内的利益,很难通过对短期数据进行分析的方式直接计算点击价值,而点击率也因为对于用户接触的核心要求变得不是唯一重要的因素。（偏向品牌广告）
</li>
<li>在这种情况下,由需求方自行根据其市场策略与预算控制单位流量的价格并按CPM方式计费,是比较合理的交易模式。
</li>
</ul>

</li>
<li>CPC(Cost per Click)计费,即按点击计费。这种方式最早产生于搜索广告,并很多为大多数效果广告网络所普遍采用。（偏向效果广告） 
<ul>
<li><b>CPC计费方式最有利于发挥供给方和需求方的长处，因而在市场上被广泛接受。</b>
</li>
<li>这种方式是把点击率的估计交给供给方(或者中间市场),而把点击价值的估计交给需求方,而需求方通过出价的方式向市场通知自己的估价。
</li>
<li>供给方的通过其收集的大量用户数据,可以根准确地估计点击率;而转化效果 是广告商站内的行为,当然他们自己的数据分析体系更能够准确地对其作出评估。
</li>
</ul>

</li>
<li>CPS(Cost per Sale)/CPA(Cost per Action)/ROI计费,即按照销售订单数、转化行为数或投入产出比来计费,而这些都是按照转化付费的一些变种。（偏向效果广告） 
<ul>
<li>这是一种极端的情况,即需求方只按照最后的转化收益来结算,从而极大程度上规避了风险。
</li>
<li>在这种计费方式下,供给方或中间市场除了估计点击率,还要对点击价值作出估计,才能合理地决定流量分配。
</li>
<li>这一方式存在两个很明显的问题:
<ul>
<li>一是转化行为并非供给方能够控制,因此也无法进行准确的估计和优化。只有那些转化流程和用户体验相似的广告商组成的广告网络,按转化付费才比较合理,典型的例子比如淘宝直通车;
</li>
<li>二是存在广告主故意降低转化率,以低成本赚取大量品牌曝光的可能。
</li>
</ul>

</li>
</ul>

</li>
<li>CPT(Cost per Time)计费,这是针对大品牌广告主特定的广告活动,将某个广告位以独占式方式交给某广告主,并按独占的时间段收取费用的方式。
<ul>
<li>CPT还有一种变形,即轮播式CPT,它是将某一广告位的流量按照某一cookie接触到的次数划分成多轮,在其中的若干轮独占式售卖给某广告主,这同样是中国市场很常见的一种售卖方式。
</li>
<li>CPT这样独占式的售卖虽然有一些额外的品牌效果和橱窗效应产生,但是非常不利于受众定向和程序交易的发展,因而长期看来比例会有下降的趋势。
</li>
</ul>

</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-1-2-3" class="outline-4">
<h4 id="sec-1-2-3"><span class="section-number-4">1.2.3</span> 计算广告系统架构</h4>
<div class="outline-text-4" id="text-1-2-3">

<p><img src="./images/ad-arch.png"  alt="./images/ad-arch.png" />
</p>
<p>
广告系统由三个主体部分构成:一个是在线的高并发投放引擎(Ad server),一个是离线的分布式数据处理平台(Grid),另一个是用于在线实时反馈的流式处理平台(Stream computing)。
</p><ul>
<li>广告投放,机即图中的Ad server。这是接受广告前端Web server发来的请求,完成广告投 放决策并返回最后页面片段的主逻辑。
</li>
<li>广告检索,包括图中的Ad index和Ad retrieval两部分。
</li>
<li>广告排序,包括图中的Ad ranking和Click modeling两部分。
</li>
<li>数据高速公路,即图中的Data highway。这部分完成的功能,是将在线投放的数据准实时传输到离线分布式计算平台与流式计算平台上,供后续处理和建模使用.
</li>
<li>用户日志生成,即图中的Session log generation。从各个渠道收集来日志,需要先整理成以用户ID为key的统一存储格式,我们把这样的日志称为用户日志(Session log)。
</li>
<li>商业智能(Business Intelligence,BI)系统,包括ETL(Extract-Transform-Load)过程, Dash- board和Cube。由于实际的广告运营不可能完全通过机器的决策来进行,其间必然需要有经验的操作者根据数据反馈对一些系统设置做及时调整。因此,实现一个功能强大,交互便利的BI系统是非常重要的。
</li>
<li>行为定向,包括结构化标签库(Structural label base), Audience targeting, 以及User attributes的cache.这部分完成的是挖掘用户日志,根据日志中的行为给用户打上结构化标签库中某些标签的过程。
</li>
<li>上下文定向,包括半在线页面抓取(Near-line page fetcher)和Page attributes的cache.这部分与行为定向互相配合,负责给上下文页面打上标签,用于在线的广告投放中。
</li>
<li>定制化用户划分,即图中的Customized audience segmentation:由于广告是媒体替广告主完成用户接触, <b>那么有时需要根据广告主的逻辑来划分用户群</b> ,这部分也是具有鲜明广告特色的模块。这个部分指的是从广告主处收集用户信息的产品接口,而收集到的数据如果需要较复杂的加工,也将经过数据高速公路导入受众定向模块来完成。这这是广告独特的功能模块,推荐系统和搜索系统是不需要这一功能的。
</li>
<li>在线行为反馈:这部分指的是一些需要准实时完成的一些任务,包括短时的用户行为标签和短时用户点击反馈等。当然,在利用日志完成这些逻辑之前,必须要进行的步骤是反作弊(Anti-spam)与计价(Billing)。需要特别指出,这一部分对于在线广告系统的效果提升意义重大: 在很多情形下,把系统信息反馈调整做得更快,比把模型预测做得更准确效果更加显著。
</li>
<li>广告管理系统:这部分是广告操作者,即客户执行(Account execute, AE)与广告系统的接口,AE通过广告管理系统定制和调整广告投放,并且与数据仓库交互,获得投放统计数据以支持决策。
</li>
<li>实时竞价接口:这是广告交易市场实时向DSP发起广告询价请求,并根据竞价结果胜出DSP的程序交易接口。它包括作为需求方时使用的RTBS(RTB for Supply),以及作为供给方时使用的RTBD(RTB for Demand)。
</li>
</ul>


</div>

</div>

<div id="outline-container-1-2-4" class="outline-4">
<h4 id="sec-1-2-4"><span class="section-number-4">1.2.4</span> 基础知识准备</h4>
<div class="outline-text-4" id="text-1-2-4">


</div>

<div id="outline-container-1-2-4-1" class="outline-5">
<h5 id="sec-1-2-4-1"><span class="section-number-5">1.2.4.1</span> 信息检索</h5>
<div class="outline-text-5" id="text-1-2-4-1">

</div>

</div>

<div id="outline-container-1-2-4-2" class="outline-5">
<h5 id="sec-1-2-4-2"><span class="section-number-5">1.2.4.2</span> 向量空间模型</h5>
<div class="outline-text-5" id="text-1-2-4-2">

<p><b>NOTE（dirlt）：相似度问题</b> 
</p>
<p>
TFIDF(Term frequency - Inverse Document Frequen- cy)值,这是一种信息检索中最常见的词强度度量,它可以分解为两个量的乘积:
</p><ul>
<li>词频(Term Frerquency, TF),即某文档中该词出现的次数;
</li>
<li>和倒数文档频率(Inverse Document Frequency, IDF),即该词在所有文档中出现的频繁程度的倒数。
</li>
<li>IDF的引入,是考虑对那些广泛出现在各个文档中的常用词对主题的鉴别力并不强,因而需要降低其权重。
</li>
</ul>


<p>
在计算两个文档的相似度时,我们一般是用其对应矢量的余弦距离
</p>
</div>

</div>

<div id="outline-container-1-2-4-3" class="outline-5">
<h5 id="sec-1-2-4-3"><span class="section-number-5">1.2.4.3</span> 最优化方法</h5>
<div class="outline-text-5" id="text-1-2-4-3">

</div>

</div>

<div id="outline-container-1-2-4-4" class="outline-5">
<h5 id="sec-1-2-4-4"><span class="section-number-5">1.2.4.4</span> 统计机器学习</h5>
<div class="outline-text-5" id="text-1-2-4-4">


</div>
</div>
</div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> 合约广告</h3>
<div class="outline-text-3" id="text-1-3">

<p>互联网广告业务开始阶段,拥有流量的媒体与需要广告资源的代理商是市场的主要参与者。 线下广告的商业逻辑也被照搬到了线上,由广告代理公司和媒体签订协议,确保某些广告位在某时间段为制定的广告商所占有,同时广告商一次性支付广告费用。这种方式与技术的关系并不大,唯一需要用到的系统就是广告排期系统.
</p>
<p>
我们讨论的合约式广告的重点,是按CPM计费、担保式投送的受众定向广告。 <b>这种售卖方式切合了在线广告的关键优势,又兼顾了线下品牌广告商的传统习惯</b> ,因此比较早地产生且被市场接受。面向合约式CPM广告的投放系统,需要解决 <b>受众定向、流量预测、点击率预测</b> 这三个基本问题,并采用在线分配的方式完成实时决策。
</p>
<p>
担保式投送的决策逻辑比较复杂,而且在目前竞价广告越来越重要的市场环境中显得有些古怪,因此有时会被技术人员和产品忽视。然而,此问题的研究却对广告中广泛存在的“量的约束下优化质”这一根本诉求给出了重要的框架,并在各种市场形态中都有变形后的具体表现形式. 因此,我们希望能从两个方面对此问题的一般性思路做清晰的介绍:
</p><ul>
<li>一是在未来流量的情况未知的情形下,如果估计在线分配算法的最差性能;
</li>
<li>二是在根据历史数据能进行相对合理的流量预测的情形下,如果利用这一信息搭建实用的在线分配系统。
</li>
</ul>


<p>
按CPM售卖的合约广告,除了上述的核心算法,还有两项广泛应用的支持技术,即流量预测和频次控制。频次控制则是广告主为了展示的有效性提出的控制性要求。
</p>

</div>

<div id="outline-container-1-3-1" class="outline-4">
<h4 id="sec-1-3-1"><span class="section-number-4">1.3.1</span> 广告位售卖和排期系统</h4>
<div class="outline-text-4" id="text-1-3-1">

<p>最早产生的广告售卖方式,是媒体和广告主约定在某一时间段内,用某些广告位的流量为该广告主投送广告,相应的结算方式为CPT方式。
</p><ul>
<li>这是一种典型的线下媒体广告投放模式,因而在互联网广告产生的早期也自然地被采用。
</li>
<li>这种方式的缺点,是基本无法做到按受众类型投放广告,因而也无法进行深入的效果优化。
</li>
<li>不过这种方式也存在一些现实的好处:
<ul>
<li>广告素材可以直接插入媒体页面,并通过CDN加速访问,因而使得广告投放延迟做得到很小（以现在的技术来说不是问题）
</li>
<li>在一些有价值媒体上广告位中长期独占式的购买,有利用形成“橱窗效应”,塑造不断攀升的品牌价值和转化效果
</li>
<li>这种销售由于可以向广告主提供一些额外的附加服务,比如同一个页面上的竞品互斥,使得高溢价的流量变现成为可能。 <b>TODO（dirlt）：如何理解？</b>
</li>
</ul>

</li>
</ul>


<p>
CPT售卖还有一种变形的形式,即按照轮播售卖。
</p>
<p>
在CPT售卖的情形下,供给方和需求方的计算需求和技术成分都不太高。需求方的参与者, 往往是4A或其他代理公司,对于广告主质和量两方面的需求,都是代理公司的人员通过对媒体广告位的历史经验,以及对广告主业务的了解,通过人工优化的方式来满足。对于供给方即媒体而言,则需要一个与代理公司沟通需求,并在合同确定以后自动地执行合同的广告管理工具,或者我们称为广告排期系统。
</p>
<p>
广告排期系统的代表性产品,有Doubleclick的DFP,以及中国市场上好耶(Allyes)的类似产品。当然,这些都是这些产品早期的形态,随着按受众售卖广告的方式越来越普及,这些产品的功能也都逐渐演进, <b>从广告排期管理逐渐拓展出其他售卖方式下媒体需要的功能,如果结合了Dynamic Allocation和RTB等功能,也就接近于供应方平台产品（SSP）了</b> 
</p>
</div>

</div>

<div id="outline-container-1-3-2" class="outline-4">
<h4 id="sec-1-3-2"><span class="section-number-4">1.3.2</span> 担保式投送</h4>
<div class="outline-text-4" id="text-1-3-2">

<p>担保式投送(guaranteed delivery, GD)是另一种常见的合约广告形式。一般来说,GD采用的是CPM结算方式,在合约中明确保证分配给广告主的流量下限。我们从供给方和需求方两方面来看这种售卖方式出现的合理性。
</p><ul>
<li>媒体从按固定广告位售卖变为按CPM售卖,初衷是为了在受众定向的基础上提高单位流量的变现能力,可是面向的仍然是原来的品牌广告主。
</li>
<li>广告主按广告位采买时,比较容易预估自己拿到的流量,可是按照人群定向的方式采买,流量有诸多不确定的因素。因此,需求方希望在合约中加入对量的保证,才能放心地采买。 <b>NOTE（dirlt）：考虑受众定向之后需要同时考虑</b>
</li>
</ul>


<p>
这里仍然要再次强调我们的观点,那就是广告主对量的要求是切实存在的,而且在某种意义上并不比对质的要求低。对大多数广告主,特别是有一定品牌诉求的广告主,一定有某一个市场环节会向其提供保证量的服务。这一点贯穿于在线广告的 发展逻辑,也是广告业务的重要特点。
</p>
<p>
当然,这里的担保并不一定是展示量上的担保,也可以是点击数或者到达数等指标上的担保。 <b>只要是在某个量上有下界式的约束,就可以认为是GD一类的问题。</b>
</p>
</div>

</div>

<div id="outline-container-1-3-3" class="outline-4">
<h4 id="sec-1-3-3"><span class="section-number-4">1.3.3</span> 在线分配问题</h4>
<div class="outline-text-4" id="text-1-3-3">

<p>映射到二部图匹配算法
</p>
<p>
<b>MRA问题</b> 
</p><ul>
<li>GD的分配方式在实际的品牌广告市场上存在一定的问题,其原因可以这样来说明:假设广告主 甲在合约中要求地域为北京的人群,其实有一层潜在的含义,那就是得到的流量尽可能符合北京人群的自然分布。假设在另一个合约中,广告主乙要的是北京的男性人群,那么为了同时满足两个合约,那么Ad Server会倾向于将北京的男性人群分配给乙。这样一来,甲得到的流量中,女性的比例就会显著高于自然分布,这并不是广告主想要的。
</li>
<li>为了尽可能缓解上述问题,我们可以对在线分配的目标函数做一些加工,使得系统在完成合约的同时,尽可能给每个广告主以代表性的流量分布。这样的分配目标,我们称为最大代表性分配(Maximally Representative Allocation, MRA)问题。
</li>
</ul>


<p>
<b>基于流量预测的方案</b>
</p><ul>
<li>虽然即时决策的限制给分配问题带来了很大的麻烦,好在历史数据对于投放决策可以起到非常强的指导作用。因此,实用的在线分配算法,都需要在根据历史数据的流量预测基础上展开。
</li>
<li>如果广告流量的分布在各个循环周期内是近似一致的,那么在线分配的问题就可以转变为离线计算的问题:只需要把根据现有合约生成Demand constraints,在上一个流量周期内离线完成带约束优化,再将优化的结果作为下一个周期内的分配策略在线执行即可。
</li>
<li>实际的Ad server中,还需要考虑的一个问题是这一分配策略不能过于庞大以至于给server带来内存和计算上的很大负担,因此,我们往往需要一个紧凑分配方案(Compact allocation plan)。
</li>
<li>除了紧凑性的要求,如果分配策略能做到一定程度上无状态,也对于Ad Server的实现非常有利:因为这样的话,多台Ad Server的物理机器之间就不需要频繁进行同步以完成状态更新,而是根据预先计算好的策略进行投放即可。这对与系统的稳健性和扩展性,有着非常大的好处。
</li>
</ul>


<p>
<b>HWM算法</b>
</p><ul>
<li>TODO(dirlt): to be read
</li>
<li><b>NOTE(dirlt): 作者给出的实现似乎有问题</b> 
</li>
</ul>


</div>

</div>

<div id="outline-container-1-3-4" class="outline-4">
<h4 id="sec-1-3-4"><span class="section-number-4">1.3.4</span> 流量预测</h4>
<div class="outline-text-4" id="text-1-3-4">

<p>流量预测的问题可以这样描述,给定某广告的一组受众标签和其他条件,以及一个eCPM的阈值,估算在将来某个时间段内能够得到的在该eCPM阈值以下的流量。其中eCPM阈值主要是用于竞价广告系统中,目的是了解在一个某一个出价水平下能够得到的流量。对于合约式广告来说,这个阈值是不需要的,或者为了工程上一致起见,将该阈值设为一个很大的数。
</p>
<p>
对于流量预测问题,基本的思路,是尽可能找到相对可比较的历史流量,根据历史数据来预测未来的流量。
</p>
</div>

</div>

<div id="outline-container-1-3-5" class="outline-4">
<h4 id="sec-1-3-5"><span class="section-number-4">1.3.5</span> 频次控制</h4>
<div class="outline-text-4" id="text-1-3-5">

<p><b>一般来说,随着某个用户看到同一个创意频次的逐渐上升,点击率呈逐渐下降的趋势这一点是可以被验证的。</b> 因此,在按照CPM采买流量时,广告主有时会要求根据频次控制某个用户接触到某创意的次数,以达到提高性价比的目的。
</p>
</div>
</div>
</div>
</div>
</div>

<!-- Baidu Analytics BEGIN --><script type="text/javascript">var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F54a700ad7035f6e485eaf2300641e7e9' type='text/javascript'%3E%3C/script%3E"));</script><!-- Baidu Analytics END --><!-- Google Analytics BEGIN --><script type="text/javascript">  var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-31377772-1']);  _gaq.push(['_trackPageview']);  (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })();</script><!-- Google Analytics END --><!-- Baidu Button BEGIN --><!-- <script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=6762177" ></script><script type="text/javascript" id="bdshell_js"></script><script type="text/javascript"> document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)</script> --><!-- Baidu Button END --><!-- G+ BEGIN --><!-- Place this render call where appropriate --><script type="text/javascript">  (function() {    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;    po.src = 'https://apis.google.com/js/plusone.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);  })();</script><!-- G+ END --><!-- DISQUS BEGIN --><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * *//* required: replace example with your forum shortname  */var disqus_shortname = 'dirlt';var disqus_identifier = 'computational-advertising.html';var disqus_title = 'computational-advertising.html';var disqus_url = 'http://dirlt.com/computational-advertising.html';/* * * DON'T EDIT BELOW THIS LINE * * */(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a><!-- DISQUS END --></body>
</html>
